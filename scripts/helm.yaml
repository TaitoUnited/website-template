global:
  domain: ${taito_domain}
  url: https://${taito_domain}
  publicPort: 443
  logProvider: ${taito_logging_provider}
  logFormat: ${taito_logging_format}
  logLevel: info    # trace, debug, info, warn, error, fatal
  registry: ${taito_container_registry}
  imagePullPolicy: ''
  debug: false

full-stack:
  ingress:
    class: nginx
    namespace: nginx-ingress
    oldRewritePolicy: false
    tls: true
    domains:
      - name: ${taito_domain}
        altName: ${taito_altdomain}

  # NOTE: See helm/values.yaml for a list of all service attributes
  # and helm/examples.yaml for some examples.
  serviceDefaults:
    # Path defaults
    basicAuthEnabled: ${taito_basic_auth_enabled}
    basicAuthHtpasswdSecret: ${taito_project}-${taito_env}-basic-auth
    # Vertical scaling
    verticalScaleUpdateMode: Off
    # Horizontal scaling
    replicas: ${kubernetes_replicas}
    autoscale: false
    autoscaleCpuPercentage: 70
    autoscaleMemoryPercentage: 70
    minReplicas: ${kubernetes_replicas}
    maxReplicas: 5
    # Env
    env:
      # Environment variables
      COMMON_ENV: ${taito_env}

  services:
    www:
      paths:
        - path:
      cpuRequest: 5m
      cpuLimit: 100m
      memoryRequest: 10Mi
      memoryLimit: 256Mi
      # Scaling
      replicas: ${kubernetes_replicas}
      autoscale: false
      minReplicas: ${kubernetes_replicas}
      maxReplicas: 5
      env:
        REPLACE_BASE_PATH:
        REPLACE_ASSETS_PATH: ${taito_cdn_project_path}/${taito_build_image_tag}/www
        REPLACE_ASSETS_DOMAIN: ${taito_cdn_domain}
      sidecar:
        enabled: false
        name: webhook
        paths:
          - path: /webhook
        port: 9000
        cpuRequest: 100m
        cpuLimit: 1000m
        memoryRequest: 512Mi
        memoryLimit: 1280Mi
        sharedVolume:
          mountPath: /service
          sidecarMountPath: /build
        livenessDisabled: true # TODO
        secrets:
          WEBHOOK_URL_PREFIX: ${taito_project}-${taito_env}-webhook.urlprefix
          SLACK_WEBHOOK_URL: ${taito_project}-${taito_env}-webhook.slackurl
          VC_TOKEN: ${taito_project}-${taito_env}-webhook.gittoken
        env:
          WEBSITE_URL: https://${taito_domain}
          SLACK_CHANNEL: taito-website
          VC_PULL_ENABLED: false
          VC_REPOSITORY_URL: ${taito_vc_repository_url}.git
